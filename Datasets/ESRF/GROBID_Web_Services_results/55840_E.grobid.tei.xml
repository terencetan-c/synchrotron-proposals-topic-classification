<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Mapping Morphological and Structural Properties of Lead Halide Perovskites by Scanning Nanofocus XRD</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author role="corresp">
							<persName><forename type="first">Samuele</forename><surname>Lilliu</surname></persName>
							<email>samuele_lilliu@hotmail.it</email>
						</author>
						<author>
							<persName><forename type="first">Thomas</forename><forename type="middle">G</forename><surname>Dane</surname></persName>
						</author>
						<author>
							<persName><forename type="first">Mejd</forename><surname>Alsari</surname></persName>
						</author>
						<author>
							<persName><forename type="first">Jonathan</forename><surname>Griffin</surname></persName>
						</author>
						<author>
							<persName><forename type="first">Alexander</forename><forename type="middle">T</forename><surname>Barrows</surname></persName>
						</author>
						<author>
							<persName><forename type="first">Marcus</forename><forename type="middle">S</forename><surname>Dahlem</surname></persName>
						</author>
						<author>
							<persName><forename type="first">Richard</forename><forename type="middle">H</forename><surname>Friend</surname></persName>
						</author>
						<author>
							<persName><forename type="first">David</forename><forename type="middle">G</forename><surname>Lidzey</surname></persName>
						</author>
						<author>
							<persName><forename type="first">J</forename><forename type="middle">Emyr</forename><surname>Macdonald</surname></persName>
						</author>
						<author>
							<persName><roleName>Dr</roleName><forename type="first">S</forename><forename type="middle">L</forename><surname>Author</surname></persName>
						</author>
						<author>
							<persName><roleName>Dr</roleName><forename type="first">J</forename><forename type="middle">G</forename><surname>Author</surname></persName>
						</author>
						<author>
							<persName><roleName>Dr</roleName><forename type="first">A</forename><forename type="middle">T B</forename><surname>Author</surname></persName>
						</author>
						<author>
							<persName><roleName>Prof. Dr</roleName><forename type="first">D</forename><forename type="middle">G L</forename><surname>Author</surname></persName>
						</author>
						<author>
							<persName><roleName>Dr</roleName><forename type="first">T</forename><forename type="middle">G D</forename><surname>Author</surname></persName>
						</author>
						<author>
							<persName><forename type="first">Miss</forename><forename type="middle">M A</forename><surname>Author</surname></persName>
						</author>
						<author>
							<persName><roleName>Prof. Dr. Sir</roleName><forename type="first">R</forename><forename type="middle">H F</forename><surname>Author</surname></persName>
						</author>
						<author>
							<persName><roleName>Dr</roleName><forename type="first">M</forename><forename type="middle">S D</forename><surname>Author</surname></persName>
						</author>
						<author>
							<persName><roleName>Dr</roleName><forename type="first">J</forename><forename type="middle">E</forename><surname>Macdonald Author</surname></persName>
						</author>
						<author>
							<affiliation key="aff0">
								<orgName type="department">Department of Physics and Astronomy</orgName>
								<orgName type="laboratory">European Synchrotron Radiation Facility</orgName>
								<orgName type="institution">University of Sheffield</orgName>
								<address>
									<addrLine>Hicks Building, Hounsfield Road</addrLine>
									<postBox>BP 220</postBox>
									<postCode>S3 7RH F-38043</postCode>
									<settlement>Sheffield Grenoble</settlement>
									<country>United Kingdom France</country>
								</address>
							</affiliation>
						</author>
						<author>
							<affiliation key="aff1">
								<orgName type="laboratory">Cavendish Laboratory</orgName>
								<orgName type="institution">University of Cambridge</orgName>
								<address>
									<addrLine>Madingley Road</addrLine>
									<postCode>CB3 0HE</postCode>
									<settlement>Cambridge</settlement>
									<country key="GB">United Kingdom</country>
								</address>
							</affiliation>
						</author>
						<author>
							<affiliation key="aff2">
								<orgName type="department">School of Physics and Astronomy</orgName>
								<orgName type="institution">Masdar Institute of Science and Technology</orgName>
								<address>
									<postBox>PO Box 54224</postBox>
									<settlement>Abu Dhabi</settlement>
									<country key="AE">United Arab Emirates</country>
								</address>
							</affiliation>
						</author>
						<author>
							<affiliation key="aff3">
								<orgName type="institution">Cardiff University</orgName>
								<address>
									<addrLine>Queens Buildings The Parade</addrLine>
									<postCode>CF24 3AA</postCode>
									<settlement>Cardiff</settlement>
									<country key="GB">United Kingdom</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Mapping Morphological and Structural Properties of Lead Halide Perovskites by Scanning Nanofocus XRD</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="MD5">D9CFFB0851F20C03E159BC53C44CD91A</idno>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.8.2" ident="GROBID" when="2025-05-24T00:15+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<label type="revision">unknown</label>
					<label type="parameters">startPage=-1, endPage=-1, consolidateCitations=1, consolidateHeader=1, consolidateFunders=0, includeRawAffiliations=false, includeRawCitations=true, includeRawCopyrights=false, generateTeiIds=false, generateTeiCoordinates=[], flavor=null</label>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>Details on the BM28 (XMaS, ESRF, Grenoble, France) beamline are available at <ref type="url" target="http://www.xmas.ac.uk/">www.xmas.ac.uk</ref>. Details on the experimental setup and the GI-WAXS geometry can be found in ref. [1] and some are reported here again for clarity.</p><p>The radiation coming from a bending magnet (critical energy Ec = 9.8 keV) was monochromatised using a fixed-exit, water-cooled, double crystal Si(111) monochromator, placed at 25 m from the source. A Rh-coated toroidal mirror was used to focus the monochromatic beam horizontally and vertically. The X-ray beam was focused to a beam spot size of ~500 × 100 μm 2 , resulting in beam footprint of ~500 × (100 / sin(αi)) μm 2 , where αi is the (out-of-plane) incident angle.</p><p>Cold, medium, and hot spun films were prepared as described in the experimental section and spin-coated at the beamline, annealed, and measured within one day. Here, samples were housed in a helium-filled custom made environmental chamber mounted on an 11-axis Huber diffractometer. <ref type="bibr" target="#b0">[1]</ref> A MAR 165 CDD detector (2048 rows × 2048 columns) was placed on the diffractometer arm at a distance of 223 mm from the sample (calibrated as in ref. <ref type="bibr" target="#b1">[2,</ref><ref type="bibr" target="#b2">3]</ref> ). Single diffraction patterns were obtained by illuminating the samples for 10 s with an X-ray beam having a wavelength of ~1.2384 Å. Data processing was performed using MATLAB software. <ref type="bibr" target="#b3">[4]</ref> </p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>The main purpose of this Supporting Information is to illustrate in great detail the analysis of data obtained from Scanning Nanofocus XRD (nXRD). We also briefly report GI-WAXS measurements and provide instructions for accessing the nXRD raw data. The paragraphs illustrated in this document (quoted in italic) are here briefly summarized.</p><p>In Grazing Incidence Wide Angle X-Ray Scattering (GI-WAXS) we report on GI-WAXS measurements performed on the cold, medium and hot samples.</p><p>In nXRD Measurements and Data Analysis we describe the nXRD beamline setup, how the measurements were conducted, and technical details of the data analysis. The paragraph contains several subparagraphs. In Spatial Resolution we discuss the resolution limits of nXRD. In Noise Removal and Average Diffraction Pattern we discuss how images were denoised and how average diffraction patterns were constructed by averaging over the 10 201 images acquired in a single scan. In Montages we show how a large 'montage' image was constructed by concatenating the 10 201 patterns acquired in a single scan. We provide a code to rebuild the montage and navigate it. In Remapping: from Pixel to Scattering Vector Coordinates we discuss the calibration procedure and the image remapping from pixel to scattering vector coordinate in transmission geometry. We provide a rigorous definition of the scattering vector expressed in polar coordinates q and χ. We also comment on the resolution. In Azimuthally Integrated Line Profiles we show how the azimuthally integrated line profiles were constructed. The obtained line profiles were used in the Rietveld refinement illustrated in Refinement. In Circular Region of Interest Around the Main Perovskite Double Peak we discuss the region of the diffraction patterns where the analysis was performed. In First Clustering Step we show how diffraction spots in single diffraction patterns were isolated or clustered by employing pairwise Euclidean distance between the pixels. In Preliminary Quiver Plot we illustrate the concept of the 'quiver plot', which is a way of representing the χ coordinate of each detected peak in spatial coordinates. In Second Clustering Step we show how the quiver plot and the spatial coordinates were employed to perform a second level of clustering which allows us to isolate single grains based on their χ orientation. We then show a method to overcome residual distortion and isolate (002) grains from (110) grains. In Maps we discuss the information that can be extracted from single grains extracted from the second clustering step, in the form of local structural maps (e.g. lattice constant or diffraction spot intensity). We report these maps for the cold, medium and hot samples. In Quiver Plots Magnifications we show magnifications of the quiver plots illustrated in the main text.</p><p>In the following paragraph, Raw Data Instructions we provide instructions (and MATLAB code) on how to use the raw data available as supporting files to plot again the data discussed in the manuscript and in the supporting information.</p><p>Figure <ref type="figure" target="#fig_0">S1</ref> shows GI-WAXS diffraction patterns recorded for the cold, medium and hot spun MAPI films measured above the critical angle (αc ≈ 0.16°) at an out-of-plane incident angle equal to αi ≈ 0.3°, achieving a penetration depth of ~140 nm. For the calculation of the GI-WAXS penetration depth we used the following expression: <ref type="bibr" target="#b4">[5]</ref> Λ</p><formula xml:id="formula_0">≈ �√2𝑘𝑘 � �(𝛼𝛼 𝑖𝑖 2 -𝛼𝛼 𝑐𝑐 2 ) 2 + 4𝛽𝛽 2 -(𝛼𝛼 𝑖𝑖 2 -𝛼𝛼 𝑐𝑐 2 )� -1<label>(1)</label></formula><p>where k = 2π/λ is the wavenumber (λ is the X-ray wavelength), αc is the critical angle, αi is the out-of-plane incident angle, and β is the imaginary part of the index of refraction. The index of refraction is defined as n = 1δ + iβ. <ref type="bibr" target="#b4">[5]</ref> The critical angle was calculated as αc = √(2δ). The δ and β parameters for CH3NH3PbI3 at λ = 1.2398 Å were estimated from the online toolbox available at ref. <ref type="bibr" target="#b5">[6]</ref> , and are equal to 3.76813 × 10 -6 and 3.06721 × 10 -7 , respectively. A plot of the penetration depth for these experiments is shown in Figure <ref type="figure">S2</ref>.</p><p>Figure <ref type="figure">S2</ref>. Calculated X-ray penetration depth in GI-WAXS vs incident angle. a, range of out-of-plane incidence angles used in the scans reported here (α i ). b, penetration depth calculated over a larger range of α i . The incident angles required to probe all the bulk in the cold (~350 nm thick), medium (~500 nm thick), and hot sample (~650 nm thick) are 0.64°, 0.9°, and 1.17° respectively. Above 0.3° the sample edge in GI-WAXS diffraction patterns increasingly hides the in-plane region of the diffraction pattern.</p><p>Close inspection of the Debye-Scherrer rings <ref type="bibr" target="#b6">[7]</ref> evident in Figure <ref type="figure" target="#fig_0">S1</ref> indicates that they are in fact composed by thousands of diffraction spots, <ref type="bibr" target="#b0">[1]</ref> as can be seen in the zoom in the insets. We plot further in-plane and out-of-plane line profiles at different incident angles in Figure <ref type="figure" target="#fig_1">S3</ref> and Figure <ref type="figure" target="#fig_2">S4</ref>. Interestingly, these measurements do not reveal any significant structural differences between the three samples nor any information on depth-related structural variation.</p><p>The only difference between the samples consists in the perovskite peak intensity, which is higher in the medium and hot samples. This corresponds to a higher degree of crystallinity in the medium and hot samples, which is confirmed by the nXRD measurements.  It is likely, however, that lattice strain and sample size effects or, equivalently, beam footprint effects (see Figure <ref type="figure" target="#fig_3">S5</ref>) play a significant role in peak broadening. Note that beam footprint effect could be minimized as suggested by Smilgies et al. <ref type="bibr" target="#b7">[8]</ref> . All these effects add up, making it difficult to quantify the lattice constants and the domain size of this class of polycrystalline materials using GI-WAXS. Note, however, that GI-WAXS is an extremely powerful technique when tracking relative changes (orientation and peak position) of individual diffraction spots in-situ during a thermal annealing. <ref type="bibr" target="#b0">[1,</ref><ref type="bibr" target="#b8">9,</ref><ref type="bibr" target="#b9">10]</ref>  showing the main perovskite peaks at q ≈ 1 Å -1 (as well as the others, not shown here) broaden as the probed sample length becomes longer. NOTE: the line profiles were slightly shifted in q to match their right edge with the line profile pos. 1. The FWHM for the line profiles at 0.3° are: 0.0408 (pos. 1), 0.0514 (pos. 2), 0.0557 (pos.</p><p>3), 0.0606 (pos. 4), and 0.0632 (pos. 5) Å -1 . Therefore, the main perovskite peak peaks at α i = 0.3°are thin (FWHM = 0.0408 Å -1 ) when a short section (~1 cm) is probed, and larger (FWHM = 0.0632 Å -1 ) when a larger section is probed (~1.6 cm). This is due to the fact that different points hit by the X-ray beam on the sample have slightly different distance between the sample and the detector.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">nXRD Measurements and Data Analysis</head><p>During data collection, samples were scanned within the y-z laboratory plane (with the X-ray beam along the x-axis), here indicated as x-y. A picture of the beamline configuration used during the nanofocus raster scan is shown in  Data Analysis was performed with a MATLAB <ref type="bibr" target="#b10">[11]</ref> application specifically designed by S. Lilliu for nXRD measurements (a snapshot of the software is shown in Figure <ref type="figure" target="#fig_6">S7</ref>). We used a custom NNB-XB0057 (NOVATECH, UK) notebook with a quad-core Intel® Core™ i7-4790K CPU 4GHz, 32GB of RAM, and Windows 7 (64bit). </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Spatial Resolution</head><p>The size of the focused X-ray beam was determined by scanning two crossed gold wires (diameter 50 µm). The gold wires act as a knife edge, meaning that the derivative of the absorption profiles corresponds to the profile of the X-ray beam in the horizontal (y, Figure <ref type="figure" target="#fig_7">S8a</ref>) and vertical (z, Figure <ref type="figure" target="#fig_7">S8c</ref>) directions. The absorption scans were smoothed with a moving average smoothing filter (black curves in Figure <ref type="figure" target="#fig_7">S8a</ref> and <ref type="figure">c</ref>) to remove noise due to variations in the incoming X-ray flux and vibration of the gold wires. The derivatives of the smoothed absorption scans (black squares in Figure <ref type="figure" target="#fig_7">S8b</ref> and <ref type="figure">d</ref>) reveal a well-defined beam profile. The nominal beam size of 200 × 200 nm was estimated from the full-width at half-maximum (FWHM) of the derivative of the smoothed absorption scans. Three methods were used to extract the FWHM: (i) manual assessment of the extent of the curve at half-maximum, (ii) Single Gaussian fitting (black curve in Figure <ref type="figure" target="#fig_7">S8b</ref> and <ref type="figure">d</ref>) and (iii) Double Gaussian fitting (blue curve in Figure <ref type="figure" target="#fig_7">S8b</ref> and <ref type="figure">d</ref>). The fit parameters and the beam profile data are summarised in Table <ref type="table">S1</ref> and Table <ref type="table">S2</ref>, respectively. A scan step size of 400nm was used to avoid strong scattering from the beam tails. This is illustrated in Figure <ref type="figure" target="#fig_7">S8b</ref> and <ref type="figure">d</ref>. The red bars in the figure illustrate the boundaries of the probed sample region in a specific point of the scan. In the horizontal direction ~89% of the beam illuminates the region indicated as 'i'. The left beam tail extends for ~9% of the total beam intensity in the region indicated as 'i-1', while the right beam tail extends for ~2% of the total beam in the region indicated as 'i+1'. In the vertical direction ~81% of the beam illuminates the region indicated as 'i'. The left beam tail extends for ~13% of the total beam intensity in the region indicated as 'i-1', while the right beam tail extends for ~6% of the total beam in the region indicated as 'i+1'.</p><p>Table <ref type="table">S1</ref>. Fit parameters for the Single and Double Gaussian fit of the horizontal (Y) and vertical (Z) beam profiles. For a description of the figures of merit refer to the Curve Fitting Toolbox (MATLAB). Table S2. Summary of the beam profile FWHM. Derivative Single Gaussian Fit Double Gaussian Fit Y 188 212 198 Z 212 254 213</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Single Gaussian Fit</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Noise Removal and Average Diffraction Pattern</head><p>Single diffraction patterns were affected by noise in the form of 1-2 pixel counts randomly distributed in the image (Figure <ref type="figure" target="#fig_9">S9a</ref>). Once these pixels were set to zero, single patterns consisted of highly sparse matrices <ref type="bibr" target="#b11">[12]</ref> (Figure <ref type="figure" target="#fig_9">S9b</ref>). As an example, the average sparsity or density <ref type="bibr" target="#b11">[12]</ref> of the 10201 diffraction images of the cold scan was (1.9 ± 1.8) × 10 -3 %. We found that the fastest way to read a single diffraction pattern was to create a memory-map <ref type="bibr" target="#b10">[11]</ref> of each EDF file and then convert the mapped file into a double matrix variable. This matrix was then converted into a sparse matrix format, <ref type="bibr" target="#b10">[11]</ref> in which data were represented as list of three elements: (row, column, counts or, equivalently, intensity). Representing matrices in the sparse format saved significant amounts of storage space and resulted in faster data processing. The time taken for data conversion was mainly limited by the low data speed transfer between the external hard drive and the processor (~50 MBps). Therefore, parallel processing did not result in any improvement. The conversion process, where the 10201 image were saved in a struct <ref type="bibr" target="#b10">[11]</ref> variable, took approximately 1 hour. This step compressed data ~2.4 × 10 4 times (from ~170 GB to ~7 MB). The average diffraction pattern of the 10201 images was calculated (in ~10 s) as the sum of the diffraction patterns divided by the number of diffraction images in a scan:</p><formula xml:id="formula_1">I av = �∑ I n N i=1 � N (<label>2</label></formula><formula xml:id="formula_2">)</formula><p>where I n is the matrix corresponding to the n-th image in a scan and N is the total number of images in the raster scan. From the average diffraction pattern shown in Figure <ref type="figure" target="#fig_10">S10a</ref> we observed some residual noise and broad diffused scattering from the substrate (Si/SiO2). We therefore reprocessed all the diffraction patterns by applying a 'clean' filter, which set to zero all the pixels surrounded by zeroes. The result for a single diffraction pattern is shown in Figure <ref type="figure" target="#fig_9">S9c</ref>. A comparison between the average diffraction pattern before and after the application of the filter is shown in Figure <ref type="figure" target="#fig_10">S10</ref>. We note that this procedure is more effective than simply subtracting diffraction patterns measured from a Si/SiO2. Reference samples are somewhat difficult to achieve for scanning nXRD. In fact, for a true reference one would have to measure the exact substrate and remount in the exact same way after sample preparation, which is practically impossible for the silicon substrates used here. For our case, we are also selecting a very limited range of q for our analysis, a q range which does not present and scattering from silicon. Moreover, the broad Si/SiO2 peak in Figure <ref type="figure" target="#fig_10">S10</ref> is only visible in the average diffraction pattern. In the single scans we observe randomly scattered pixels around this peak, which can be easily removed with our de-noising procedure. Figure <ref type="figure" target="#fig_0">S11</ref> shows an overlay between the sparse matrix of the average diffraction pattern (in red colour) and the first diffraction pattern of the cold sample (a, in blue colour), or an average diffraction pattern performed on the first N = 10, 100, 1000, and 1440 patterns (b, c, d, e, f, in blue colour, respectively), through equation ( <ref type="formula" target="#formula_1">2</ref>). An animation is available at the following link: <ref type="url" target="https://youtu.be/hFTLnVBRurY">https://youtu.be/hFTLnVBRurY</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Figure S11</head><p>. Overlay between the average diffraction pattern constructed using all the images in a scan (N = 10 201) and the ones constructed using N images through eq. ( <ref type="formula" target="#formula_1">2</ref>). The average diffraction pattern constructed using all the images in a scan (10 201) is shown in red in the 6 images. The average diffraction pattern constructed using the first N images is shown in blue colour. Data is displayed as sparse matrices for clarity. Data employed here is from the 'cold' sample. A full sequence from N = 0 to N = 1440 is available at <ref type="url" target="https://youtu.be/hFTLnVBRurY">https://youtu.be/hFTLnVBRurY</ref>.</p><p>When recording diffraction patterns in GI-WAXS using much larger beams, a larger number of grains are illuminated, with such grains having different relative separations from the detector. Here, single grains are probed in transmission with a nanofocussed beam at a fixed grain-detector separation. As a consequence, the Debye-Scherrer rings in the nXRD average pattern are not affected by sample-size broadening and are significantly sharper than the Debye-Scherrer rings measured in GI-WAXS geometry.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">Montages</head><p>Scan 'montages' were constructed by concatenating the 10201 patterns of a single scan in a 101 × 101 frame consisting of a large 218867 × 209070 sparse matrix, as illustrated in the MATLAB code shown in Table <ref type="table">S3</ref>. The files required for plotting the montages are available as supporting files as discussed at the end of this document.</p><p>Table <ref type="table">S3</ref>. MATLAB code illustrating how the montage matrix was built. In the first section of the code a LOOKUP matrix containing the diffraction pattern indexes arranged in a 101 × 101 matrix is built. In the second section the MONTAGE matrix is built. DataSize is an array containing the size of a single diffraction pattern, as  The coordinates correspond to the relative point in space were the scan was performed. Single tiles, here indexed as (i,j) correspond to a single diffraction pattern, where i is the row scan index and j is the column scan index. NOTE: (i, j) are not Miller indices.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.4">Remapping: from Pixel to Scattering Vector Coordinates</head><p>A diffracting sample projects a cone of rays (Debye-Scherrer rings <ref type="bibr" target="#b6">[7]</ref> ) onto the detector. The projection of this cone onto a flat detector perpendicular to the direct beam is a circle. However, for various reasons, the detector might not be perfectly perpendicular to the direct beam. As a result, the rings appear on the acquired image as tilted ellipses, rather than circles. <ref type="bibr" target="#b2">[3]</ref> The 'calibration' step consisted in extracting the parameters required for correcting this distortion and converting the row and column image coordinates into scattering vector coordinates. <ref type="bibr" target="#b2">[3]</ref> The geometry employed in the calibration is described in ref. <ref type="bibr" target="#b12">[13]</ref> . Diffraction patterns from the α-Al2O3 were measured before the experiments. With the pyFAI-calib library <ref type="bibr" target="#b13">[14]</ref><ref type="bibr" target="#b14">[15]</ref><ref type="bibr" target="#b15">[16]</ref> we extracted the distance between the sample and the detector, 3 rotation angles (rot1, rot2, rot3), and the points of normal incidence (PONI), <ref type="bibr" target="#b12">[13]</ref> which were used in the conversion of the diffraction image coordinates from rows and columns to scatting vector polar coordinates, as discussed in the next section. The extracted parameters are reported in Table <ref type="table">S4</ref>.</p><p>Table <ref type="table">S4</ref>. Calibration Parameters extracted with the pyFAI-calib library <ref type="bibr" target="#b16">[17]</ref> .</p><p>in pixels in meters in radians sample-detector distance 2588.760886 0.194157066 -PONI (row) 1153.703231 0.086527742 -PONI (column) 1742.352078 0.130676406 -rot1 --0.012397374 rot2 --0.003393846 rot3 --0</p><p>These parameters were used for converting row and column image coordinates into scattering vector coordinates in the following way ('remapping' step). We first calculated the detector rotation matrix R</p><formula xml:id="formula_3">𝐑𝐑 1 = � 1 0 0 0 cos 𝜌𝜌 1 -sin 𝜌𝜌 1 0 sin 𝜌𝜌 1 cos 𝜌𝜌 1 �<label>(3)</label></formula><formula xml:id="formula_4">𝐑𝐑 2 = � cos 𝜌𝜌 2 0 sin 𝜌𝜌 2 0 1 0 -sin 𝜌𝜌 2 0 cos 𝜌𝜌 2 � (4) 𝐑𝐑 = 𝐑𝐑 2 𝐑𝐑 1<label>(5)</label></formula><p>where ρ1 = -rot1, ρ2 = -rot2, rot1 and rot2 are the detector rotation angles extracted from the calibration (see Table <ref type="table">S4</ref>). We then calculated:</p><formula xml:id="formula_5">𝑝𝑝 = � 𝑐𝑐 -PONI𝑐𝑐 𝑟𝑟 -PONI𝑟𝑟 𝐿𝐿 �<label>(6)</label></formula><p>where c and r are the column and row coordinates of a non-zero pixel in the diffraction pattern, PONIc is the column coordinate of the point of normal incidence, <ref type="bibr" target="#b14">[15]</ref> and PONIr its row coordinate. The point p was rotated through the detector rotation matrix:</p><formula xml:id="formula_6">𝑡𝑡 = � 𝑡𝑡 1 𝑡𝑡 2 𝑡𝑡 3 � = 𝐑𝐑𝑝𝑝<label>(7)</label></formula><p>The Bragg angle in radians 2𝜃𝜃 is: <ref type="bibr" target="#b6">[7,</ref><ref type="bibr" target="#b12">13]</ref> 2𝜃𝜃 = atan2 ��𝑡𝑡 1 2 + 𝑡𝑡 2 2 , 𝑡𝑡 3 � (8)</p><p>The norm of the scattering vector q is: <ref type="bibr" target="#b6">[7]</ref> 𝑞𝑞</p><formula xml:id="formula_7">= 4𝜋𝜋 𝜆𝜆 sin 2𝜃𝜃 2<label>(9)</label></formula><p>And the azimuth in radians is:</p><formula xml:id="formula_8">𝜒𝜒 ′ = -atan2(𝑡𝑡 1 , 𝑡𝑡 2 ) 𝜒𝜒 = � 𝜒𝜒 ′ for 𝜒𝜒 ′ &gt; 0 𝜒𝜒 ′ + 2𝜋𝜋 for 𝜒𝜒 ′ &lt; 0 (10)</formula><p>For easier data processing and visualization we used χ (instead of 𝜒𝜒 ′ ) in degrees (from 0° to 360°). Therefore, the 'remapping' step remapped a non-zero (row, column, intensity) triplet into a (q, χ, intensity) triplet. In Figure <ref type="figure" target="#fig_0">S13</ref> we show the q, χ coordinates, or simply polar coordinates (distance and azimuth), for a diffraction spot.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Figure S13. Representation of the scattering vector in polar coordinates (q, χ).</head><p>The extraction of azimuthally integrated line profiles required two further steps: rebinning and averaging. The intensities of the (q, χ, intensity) triplet were average-binned into a sparse matrix having a regular step size for q and χ (Δq = 1 × 10 -3 Å -1 and Δχ = 0.5°). The choice of the step size had to take into account the q resolution. In fact, the size of pixels close to the direct beam (q ≈ 0 Å -1 ) is Δq ≈ 3 × 10 -3 Å -1 , while the size of pixels close to the left edge of the diffraction pattern (q ≈ 4.3 Å -1 ) is Δq ≈ 2 × 10 -3 Å -1 . Therefore, we can set the resolution to Δq ≈ (2.5±0.5) × 10 -3 Å -1 . As a consequence, a step size of Δq &lt; 1 × 10 -3 Å -1 would result in oversampling and noisy data.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.5">Azimuthally Integrated Line Profiles</head><p>In the binning step we collected all the elements from the triplet that fell into the (m,n)-th bin, i.e with q coordinates between mΔq and (m-1)Δq and χ coordinates between nΔχ and (n-1)Δχ, and calculated the average of the intensity of these elements. The obtained 'polar' matrix I(q,χ) was then used for the calculation of the 'average azimuthally integrated line profiles':</p><formula xml:id="formula_9">𝑖𝑖(𝑞𝑞) = � 𝐼𝐼(𝑞𝑞, 𝜒𝜒) 𝑁𝑁 𝑞𝑞 360°𝜒𝜒 =0°<label>(11)</label></formula><p>where, here, the azimuthal integration was performed from 0° to 360°, and Nq is the number of elements with the same q. In practice, the line profile was simply calculated as mean(I) in MATLAB. Line profiles extracted from the average diffraction pattern of the cold, medium, and hot sample are shown in Figure <ref type="figure" target="#fig_13">S14</ref>. With our MATLAB application it is possible to inspect single diffraction patterns in real time by simply selecting the image index, the column and row of the raster scan, or by simply pressing up/down or left/right arrows. The line profile extraction, which includes 'remapping' and 'binning' is performed in real time. The processing time for these two steps is ~1.2 ms per image (average value calculated on the 10201 images of the cold sample). Note that the processing speed is inversely proportional to the density of the sparse matrices.</p><p>Parallel processing or GPU processing <ref type="bibr" target="#b10">[11]</ref> was not an option for highly sparse dataset, as the time taken to dispatch/collect the job or to generate a GPU variable and retrieve results after processing was longer than the actual processing time.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.5.1">Refinement</head><p>The line profile extracted from the average diffraction pattern of the three samples were converted into 2θ coordinates. The MAPI crystallographic file used for the Rietveld refinement <ref type="bibr" target="#b17">[18]</ref> was obtained from ref. <ref type="bibr" target="#b18">[19]</ref> The pattern was fitted with Pseudo-Voigt functions. <ref type="bibr" target="#b4">[5]</ref> Results are shown in Figure <ref type="figure" target="#fig_0">S15</ref>, Table <ref type="table">S5</ref>, Table <ref type="table">S6</ref>, Table <ref type="table">S7</ref>, and Table <ref type="table">S8</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Figure S15. Comparison between measurements and simulated diffraction pattern from the refined tetragonal cell (cold sample).</head><p>Table <ref type="table">S5</ref>. Cold sample, first 40 reflections from the simulated diffraction pattern obtained from the refined crystal.</p><formula xml:id="formula_10">q [Å -1 ] relative intensity h k l q [Å -1 ] relative intensity h k l q [Å -1 ] relative intensity h k l q [Å -</formula><p>1 ] relative intensity h k l 0.992 97.331 0 0 2 2.234 28.760 2 2 2 2.976 3.942 0 0 6 3.457 18.893 4 0 1.001 100.000 1 1 0 2.238 40.464 3 1 0 2.991 43.671 3 1 4 3.559 0.492 3 2 1.409 9.329 1 1 2 2.437 8.509 2 0 4 3.000 8.756 4 0 2 3.573 1.816 4 3 1.416 8.647 2 0 0 2.448 13.966 3 1 2 3.003 2.321 3 3 0 3.587 6.088 2 2 1.659 16.267 2 1 1 2.600 1.651 3 2 1 3.140 1.188 1 1 6 3.599 3.731 3 3 1.729 16.372 2 0 2 2.819 53.241 2 2 4 3.162 0.058 3 3 2 3.609 4.249 5 1 1.984 62.237 0 0 4 2.831 17.564 4 0 0 3.165 3.639 4 2 0 3.724 3.630 3 1 2.002 66.359 2 2 0 2.942 2.798 2 1 5 3.276 5.433 4 1 3 3.736 6.068 4 2 2.172 8.169 2 1 3 2.954 1.073 3 2 3 3.296 0.710 2 0 6 3.743 1.187 5 1 2.222 50.505 1 1 4 2.960 8.060 4 1 1 3.317 0.078 4 2 2 3.816 0.792 2 1 Table S6. Medium sample, first 40 reflections from the simulated diffraction pattern obtained from the refined crystal. q [Å -1 ] relative intensity h k l q [Å -1 ] relative intensity h k l q [Å -1 ] relative intensity h k l q [Å -1 ] relative intensity h k l 0.992 97.295 0 0 2 2.234 28.756 2 2 2 2.977 3.940 0 0 6 3.457 18.888 4 0 4 1.001 100.000 1 1 0 2.238 40.463 3 1 0 2.991 43.659 3 1 4 3.559 0.492 3 2 5 1.409 9.326 1 1 2 2.438 8.505 2 0 4 3.000 8.755 4 0 2 3.574 1.816 4 3 1 1.416 8.647 2 0 0 2.448 13.964 3 1 2 3.003 2.321 3 3 0 3.587 6.085 2 2 6 1.659 16.266 2 1 1 2.600 1.651 3 2 1 3.140 1.187 1 1 6 3.599 3.730 3 3 4 1.729 16.368 2 0 2 2.819 53.224 2 2 4 3.163 0.058 3 3 2 3.609 4.249 5 1 0 1.984 62.211 0 0 4 2.831 17.563 4 0 0 3.165 3.639 4 2 0 3.724 3.628 3 1 6 2.002 66.358 2 2 0 2.942 2.797 2 1 5 3.276 5.432 4 1 3 3.736 6.066 4 2 4 2.173 8.167 2 1 3 2.954 1.072 3 2 3 3.296 0.709 2 0 6 3.743 1.187 5 1 2 2.223 50.485 1 1 4 2.960 8.059 4 1 1 3.317 0.078 4 2 2 3.816 0.792 2 1 7</p><p>Table <ref type="table">S7</ref>. Hot sample, first 40 reflections from the simulated diffraction pattern obtained from the refined crystal.</p><formula xml:id="formula_11">q [Å -1 ] relative intensity h k l q [Å -1 ] relative intensity h k l q [Å -1 ] relative intensity h k l q [Å -</formula><p>1 ] relative intensity h k l 0.993 97.550 0 0 2 2.235 28.767 2 2 2 2.979 3.949 0 0 6 3.458 18.898 4 0 4 1.001 100.000 1 1 0 2.239 40.462 3 1 0 2.992 43.695 3 1 4 3.560 0.493 3 2 5 1.410 9.336 1 1 2 2.439 8.517 2 0 4 3.001 8.756 4 0 2 3.574 1.816 4 3 1 1.416 8.646 2 0 0 2.449 13.967 3 1 2 3.003 2.321 3 3 0 3.589 6.094 2 2 6 1.659 16.268 2 1 1 2.600 1.651 3 2 1 3.142 1.190 1 1 6 3.600 3.732 3 3 4 1.729 16.376 2 0 2 2.820 53.274 2 2 4 3.163 0.058 3 3 2 3.610 4.248 5 1 0 1.986 62.362 0 0 4 2.832 17.562 4 0 0 3.166 3.639 4 2 0 3.726 3.633 3 1 6 2.002 66.354 2 2 0 2.944 2.801 2 1 5 3.277 5.434 4 1 3 3.737 6.069 4 2 4 2.173 8.174 2 1 3 2.955 1.073 3 2 3 3.298 0.710 2 0 6 3.744 1.187 5 1 2 2.224 50.575 1 1 4 2.961 8.059 4 1 1 3.318 0.078 4 2 2 3.819 0.793 2 1 7 Table S8. Refined Lattice Constants Parameters. a, b c Cold 8.877 12.666 Medium 8.877 12.665 Hot 8.876 12.657</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.6">Circular Region of Interest Around the Main Perovskite Double Peak</head><p>To process data within a certain q range we defined circular regions of interest (ROIs). Figure <ref type="figure" target="#fig_14">S16</ref> shows an example of ROIs including data from the (002) and the (110) reflections, from the average pattern. Here we used the average pattern just to display the concept of circular ROI, as single diffraction patterns would only display a few scattered diffraction spots. We first generated a binary mask by defining an annulus in a 2167 × 2070 (which is the same size of a single diffraction image) null matrix with a large radius R = 355 pixels and a small radius r = 336 pixels and assigning 1 to the pixels inside it. The binary mask was converted into a sparse matrix and multiplied point by point to the (i,j)-th diffraction pattern of the raster scan. This allowed us to consider only data from the (002) and (110) reflections. The analysis followed two conceptual steps: (i) diffraction spots clustering in the single diffraction patterns and extraction of their features including the peak position, (ii) spots clustering on the full dataset based on the spatial distance in the raster scan and on the spot orientation (χ).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.7">First Clustering Step</head><p>We now discuss the first step. The following steps were repeated for each of the 10201 diffraction patterns in a scan. The row, column and intensity vectors were extracted from the sparse matrix representing the ROI described above in a single diffraction pattern. Rows and columns were remapped (see equations above) into q and χ coordinates. Row and column vectors defining the pixel positions in ROI of the diffraction pattern were clustered based on the pairwise Euclidean distance between the pixels. <ref type="bibr" target="#b10">[11]</ref> We used a threshold of 0.8 for cutting the hierarchical tree. <ref type="bibr" target="#b10">[11]</ref> As an example, the ROI of the first diffraction pattern of the scan displayed only one diffraction spot, i.e. only one cluster of 83 pixels. This is shown in Figure <ref type="figure" target="#fig_15">S17a</ref> in pixel coordinates. The cluster represented as a set of q, χ and intensity coordinates (inset in Figure <ref type="figure" target="#fig_15">S17a</ref>) was fitted with a cubic spline interpolant using a mesh with a regular q, χ step size (Figure <ref type="figure" target="#fig_15">S17b</ref>). The maximum intensity was extracted and the corresponding q, χ were labelled as the peak position (qp, χp). A line profile (Figure <ref type="figure" target="#fig_15">S17c</ref>) passing by the peak position and the origin of the diffraction pattern was extracted and used for the extraction of the left hand side width at half maximum (LHS), right hand width at half maximum (RHS), and the full width at half maximum (FWHM = LHS + RHS). This was the simplest case. Since the ROI used for this analysis includes two reflections (002) and (110), we also observed diffraction spots with double peaks. Figure <ref type="figure" target="#fig_15">S17d</ref> (image index 3) shows a diffraction spot displaying both reflections in the ROI of the third diffraction pattern.</p><p>The most complicated case was when the ROI of a single diffraction pattern displayed multiple diffraction spots. This is shown in Figure <ref type="figure" target="#fig_15">S17g</ref> (image index 1718). The three diffraction spots were clustered as shown in the inset. Figure <ref type="figure" target="#fig_15">S17h</ref> and i show the previously described graphs for the second cluster.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.7.1">Preliminary Quiver Plot</head><p>Once this procedure was iterated for the 10201 diffraction patterns, we generated a quiver <ref type="bibr" target="#b10">[11]</ref> (or velocity) plot representing the χ coordinate of each detected peak in spatial coordinates. As for the montage, the first diffraction pattern, which displayed only one diffraction spot, resulted in an arrow with origin at (0.2, 0.2) μm, an angle corresponding to χ, and a colour corresponding the a one to one correspondence between the angles from 0° to 360° and a jet colour map. <ref type="bibr" target="#b10">[11]</ref> The above mentioned ROI of image index 1718, which was made of 3 diffraction spots in the ROI, resulted in three arrows with angles equal to 310.1°, 119.21°, 299.81°. A quiver plot was employed as it allowed visualizing multiple peaks on the same spatial position. This is illustrated in Figure <ref type="figure" target="#fig_16">S18</ref>. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.8">Second Clustering Step</head><p>We now discuss the second step. We performed as second level of clustering on (x, y, χ), where χ is the χ coordinate of diffraction spot and x, y are the spatial coordinates of the point where the diffraction pattern containing the diffraction spot was taken. The purpose of the second level of clustering was to identify crystallites or grains based on their crystallographic orientation. The method used for this clustering is similar to the previous, with the difference that this one is performed in three dimensions and on different coordinates. Figure <ref type="figure" target="#fig_17">S19</ref> shows results for the first two largest detected clusters, along with maps of the q, χ coordinates of the peak extracted from the diffraction spots within the clustered grain. In Figure <ref type="figure" target="#fig_17">S19b</ref> and <ref type="figure">c</ref> we can observe two regions corresponding to different q and χ values. The region on top clearly belongs to the (002) reflection, while the one on the bottom belongs to the (110) reflection. An accurate analysis should take into account that (002) and ( <ref type="formula">110</ref>) are different peaks. Peaks segregation had to be implemented in simple and robust way. We could not perform this step by defining a finer ROI separating the (002) from (110) reflections because the ROI was defined on the raw pattern, which presented distortion due to detector misalignment (non-circular pattern).</p><p>Figure <ref type="figure" target="#fig_18">S20</ref> shows a plot of q vs. χ for the peak extracted from all the diffraction spots in the raster scan. These values were obtained after applying the distortion correction equations described above. The expected q vs. χ curve should have been flat with some fluctuations. However, we found that the graph was best fitted by a 4 th order polynomial (red curve), which confirmed that the distortion caused by the rotated detector was not completely removed. This was so far the best distortion correction we could obtain. We observed that the fitting curve could be used to discriminate between the (002) and the (110) reflections.</p><p>Figure <ref type="figure" target="#fig_19">S21</ref> shows the diffraction spot extracted from the 113 th diffraction pattern (cold sample). The green line in Figure <ref type="figure" target="#fig_19">S21a</ref> is a plot of the 4 th degree polynomial (shifted up for clarity), which passes between the two diffraction peaks. If we opt for the detection of the peak below this line, i.e. (002), we find q = 0.9915 Å -1 and χ = 228.14° as the detected peak. The line profile passing by χ = 228.14° is shown in Figure <ref type="figure" target="#fig_16">S18b</ref>. If we opt for the detection of peaks above this line, i.e. (110), we find q = 1.0003 Å -1 and χ = 227.51° as the detected peak. The line profile passing by χ = 227.51° is shown in Figure <ref type="figure" target="#fig_19">S21c</ref>. For both line profiles we fit the detected peak with a double Gaussian. Double Gaussians were used to take into account peak asymmetries, approximate quite well pseudo-Voigt profiles, and are easier and more robust to fit than pseudo-Voigt functions. Finally, we repeated the steps illustrated here twice for the ROIs corresponding to the 10201 images in a scan. The first time we focused on the (002) reflection, and the second time we focused on the (110) reflection.   <ref type="figure">c</ref>, <ref type="figure">d</ref>, diffraction spot q p peak position. e, f, lattice constant calculated from q p . g, h, diffraction spot χ p peak position. i, j, diffraction spot peak intensity. k, l, FWHM extracted from the line profile passing by χ p and q p and the origin of the diffraction pattern.  <ref type="figure">c</ref>, <ref type="figure">d</ref>, diffraction spot q p peak position. e, f, lattice constant calculated from q p . g, h, diffraction spot χ p peak position. i, j, diffraction spot peak intensity. k, l, FWHM extracted from the line profile passing by χ p and q p and the origin of the diffraction pattern. Note that l is blank because the identified diffraction spots did not contain enough pixels for a good estimate of the FWHM.       </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>4</head><p>Raw Data Instructions</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1">nXRD</head><p>We provide six *.mat files named cold_002, cold_110, medium_002, medium_110, and hot_002, hot_110, which contain the data processed by our software and discussed in this work. The raw data in *.edf format (510 GB) can be requested either to the ID13 beamline or by sending an email to samuele_lilliu@hotmail.it. The *.mat files can be opened using MATLAB by simply dragging and dropping them to the Workspace. The data is accessible from the variable 'nongraphicHandles'. The data structures listed in Table <ref type="table">S9</ref> are common to the '002' and '110' files (e.g. would be the same in both cold_002 and cold_110) are generated before the first clustering step discussed above.</p><p>Table S9. Data structures common in both 002 and 110 files. Struct Name Type Description nongraphicHandles.data{n} Sparse matrix Single full diffraction pattern. n can be any integer number between 1 and 10201. nongraphicHandles.montage.ImageL Sparse matrix Montage (as shown in Figure 2) nongraphicHandles.image.Iav Sparse matrix Average diffraction pattern (as shown in Figure 2). nongraphicHandles.image.ImageSum Sparse matrix 101 × 101 image where the n-th pixel corresponds to the average intensity of the n-th full diffraction pattern in a scan. NOTE: 'Sum' is just a name.</p><p>Sparse patterns can be visualized through the command 'spy'. Unfortunately, the spy command does not render intensities with different colors. A simple workaround can be found at the beginning of the code in Table <ref type="table">S10</ref>, which can be used for plotting the montage.</p><p>Table S10. Simple improvement to the 'spy' command and code for plotting the montage. I0 = nongraphicHandles.montage.ImageL; [x,y, I] = find(I0); scatter(y, x, 10, I,'.'); set(gca,'CLim',[3 10]); xlim([min(y)-500 max(y)+500]); ylim([min(x)-500 max(x)+500]); c = colorbar; ax = gca; set(ax, 'Visible', 'on'); set(ax, 'layer', 'top'); set(ax, 'GridLineStyle','-'); set(ax, 'Xgrid', 'on'); set(ax, 'Ygrid', 'on'); S = size(I0); xgap = 10; ygap = 10; xgap_pel = (S(2)/nongraphicHandles.input.scansize_um(2))*xgap; xTick = [1 round(xgap_pel:xgap_pel:S(2))]; xTickLabel = [0 xgap:xgap:nongraphicHandles.input.scansize_um(2)]; set(ax,'xTick',xTick); set(ax,'xTickLabel',xTickLabel); xlabel('Distance [\mum]'); ygap_pel = (S(1)/nongraphicHandles.input.scansize_um(1))*ygap; yTick = [1 round(ygap_pel:ygap_pel:S(1))]; yTickLabel = fliplr([0 ygap:ygap:nongraphicHandles.input.scansize_um(1)]); set(ax,'yTick',yTick); set(ax,'yTickLabel',yTickLabel); ylabel('Distance [\muum]');</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Figure S1 .</head><label>S1</label><figDesc>Figure S1. GI-WAXS diffraction patterns of cold (a), medium (b) and hot (c) spun MAPI films. The arrows in part a indicate the azimuthal angle (χ) of the cake slice used for extracting the out-of-plane line profile (χ = 7°) and the in-plane line profile (χ = 71°), which are both shown in each figure. The dotted lines indicate the cake slice aperture (χ = 10°) that is used in the line profile integration. The images in the top corner represent a zoom of the square region of interest indicated in blue. Diffraction patterns are normalized between 0 and 1 and are represented on a linear scale.</figDesc><graphic coords="4,72.00,127.20,451.26,366.72" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Figure S3 .</head><label>S3</label><figDesc>Figure S3. In-plane and Out-of-plane line profiles at different out-of-plane incident angles.</figDesc><graphic coords="6,86.22,223.80,453.48,467.52" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Figure S4 .</head><label>S4</label><figDesc>Figure S4. Fine α i scan. a, b, c in-plane line profiles. d, e, f out-of-plane line profiles.</figDesc><graphic coords="7,86.22,72.00,453.48,283.32" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Figure S5 .</head><label>S5</label><figDesc>Figure S5. GI-WAXS diffraction patterns from a perovskite films (medium spun) deposited on a substrate with a trapezoidal shape and measured at different positions of the trapezoid. Positions are shown in the insets. a, position 1 (~1 cm, short). b, position 2 (~1.2 cm). c, position 3 (~1.3 cm). d, position 4 (~1.5 cm). e, position 5 (~1.6 cm, large). NOTE: These are estimated distances. f, in-plane line profiles (χ = 83°, Δχ = 7°)showing the main perovskite peaks at q ≈ 1 Å -1 (as well as the others, not shown here) broaden as the probed sample length becomes longer. NOTE: the line profiles were slightly shifted in q to match their right edge with the line profile pos. 1. The FWHM for the line profiles at 0.3° are: 0.0408 (pos. 1), 0.0514 (pos. 2), 0.0557 (pos.3), 0.0606 (pos. 4), and 0.0632 (pos. 5) Å -1 . Therefore, the main perovskite peak peaks at α i = 0.3°are thin (FWHM = 0.0408 Å -1 ) when a short section (~1 cm) is probed, and larger (FWHM = 0.0632 Å -1 ) when a larger section is probed (~1.6 cm). This is due to the fact that different points hit by the X-ray beam on the sample have slightly different distance between the sample and the detector.</figDesc><graphic coords="8,86.22,182.40,451.26,253.98" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Figure S6 .</head><label>S6</label><figDesc>Each scan consisted of a 40 × 40 μm 2 raster scan of 101 × 101 pixels, with a step size of 400 nm. A single scan resulted in 10201 2167 × 2070 pixel diffraction images, for a total of ~170 GB of data saved in the ESRF Data Format (EDF).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Figure S6 .</head><label>S6</label><figDesc>Figure S6. ID13 (ESRF) beamline setup during the raster scan. a, The photo shows the optical microscope position during the XRD measurements, the detector, and the sample positioned on the xyz piezo scanning stages. b, Close-up photo showing the slits, the beamstop, the sample mounted on the sample through a microscope slide, and the xyz piezo scanning stages.</figDesc><graphic coords="9,86.22,196.20,453.30,240.72" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head>Figure S7 .</head><label>S7</label><figDesc>Figure S7. Snapshot of the MATLAB application for nanofocus data processing developed by S. Lilliu. This snapshot shows only two of the many available panels. The panels on the left displays the average diffraction pattern and is also used to display single diffraction patterns. The panel on the right displays the sparse pattern of the montage. The controls at the centre are used to navigate the 10201 single diffraction patterns across the scan area, to adjust the figures, to control data processing, and to input the calibration parameters, as discussed in the following paragraphs.</figDesc><graphic coords="10,98.88,141.00,411.72,216.30" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head>Figure S8 .</head><label>S8</label><figDesc>Figure S8. Beam Profiling Data. a and c, Absorption scans (black squares) and smoothed data (black lines) for the horizontal and vertical beam profiles, respectively. b and c, derivative of the smoothed absorption data (black squares), single Gaussian fits (black lines), and double Gaussian fits (blue lines). The estimated FWHM is highlighted with two blue arrows. The indices i-1, i, i+1 indicate three points of the raster scan. The percentage values indicate the percentage of the illuminated are in a specific region.</figDesc><graphic coords="11,72.00,287.04,451.26,338.46" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8"><figDesc>) = a1*exp(-((x-b1)/c1)^2) Coefficients (with 95% confidence bounds): a1 = 0.9724 (0.9438, 1.001) b1 = -0.001223 (-0.004273, 0.001826) c1 = 0.1271 (0.1228, 0.1314) Goodness of fit: SSE: 0.1395 R-square: 0.9751 Adjusted R-square: 0.9747 RMSE: 0.02981 General model Gauss2: f(x) = a1*exp(-((x-b1)/c1)^2) + a2*exp(-((x-b2)/c2)^2) Coefficients (with 95% confidence bounds)) = a1*exp(-((x-b1)/c1)^2) + a2*exp(-((x-b2)/c2)^2) Coefficients (with 95% confidence bounds)</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_9"><head>Figure S9 .</head><label>S9</label><figDesc>Figure S9. Noise removal from a single diffraction pattern (cold sample, first image). a, Diffraction pattern image as imported from the EDF file and displayed as a grayscale image. d, Sparsity pattern of image in a. b, Image after setting pixel with counts equal to 1 and 2 to zero. e, Sparsity pattern of image in b. c, Image after removing pixels surrounded by zero pixels ('clean' filtering). f, Sparsity pattern of c. The direct beam is shown as a red cross. Image coordinates are in pixels. For the grayscale images displayed here data was clipped above 10 counts, normalized between 0 and 1 and converted into grayscale format, and the contrast was adjusted between 0 and 1e-4. The 'clean' filtering consisted in converting the sparse image into a full image and then applying the bwmorph MATLAB function with the 'clean' option.</figDesc><graphic coords="13,134.52,286.14,339.84,226.32" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_10"><head>Figure S10 .</head><label>S10</label><figDesc>Figure S10. Average diffraction pattern (cold sample) before (a) and after (b) 'clean' filtering. Note that the broad scattering from the substrate is almost completely removed after filtering.</figDesc><graphic coords="14,191.52,265.20,226.32,119.22" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_11"><figDesc>[sizeRow sizeCol] = [2167 2070]. The struct PATTERN{n} contains the 10201 full diffraction patterns represented as sparse matrices. The for loop goes from the first diffracton pattern (index 1) until the last (numel(data) = 10201). The MONTAGE sparse matrix has a final size of 218867 rows and 209070 columns.10102 10203 … 10201] count = 0; for i = 1 : 101 for j = 1 : 101 count = count+1; LOOKUP(i,j) = count ; end end % Montage DataSize = size(PATTERN{1}); S1 = DataSize(1); S2 = DataSize(2); for n = 1 : numel(data) [row col] = find(LOOKUP == n); MONTAGE(row*S1-S1+1: row*S1, col*S2-S2+1: col*S2) = PATTERN{n}; end Spatial coordinates were assigned to the centre of each diffraction pattern according to the raster scan. The concept is illustrated in Figure S12 for 25 spatially adjacent diffraction patterns (cold sample). With a 40 × 40 μm 2 scan area, the 101 × 101 scan points split the scan area into 0.4 × 0.4 μm 2 tiles. To avoid negative values, we centred the first scan point (1,1) or tile at (0.2, 0.2) μm. Therefore, the last point of the scan is located at (40.2, 40.2) μm.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_12"><head>Figure S12 .</head><label>S12</label><figDesc>Figure S12. Montage: concept. Montage of the diffraction patterns from the cold sample scan including patterns with scan column and row index (indicated in figure) ranging from 1 to 5.The coordinates correspond to the relative point in space were the scan was performed. Single tiles, here indexed as (i,j) correspond to a single diffraction pattern, where i is the row scan index and j is the column scan index. NOTE: (i, j) are not Miller indices.</figDesc><graphic coords="17,163.02,72.00,283.26,240.78" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_13"><head>Figure S14 .</head><label>S14</label><figDesc>Figure S14. Azimuthally integrated line profiles in linear and logarithmic scale from the average diffraction patterns for the cold (a,b), medium (c,d), and hot sample (e,f).</figDesc><graphic coords="20,86.22,277.38,453.54,340.32" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_14"><head>Figure S16 .</head><label>S16</label><figDesc>Figure S16. Circular regions of interest. Circular region of interest including the (002) and (110) reflections shown on the average diffraction pattern for the cold (a), medium (b), and hot sample (c). The selected region of interest included data from 336 to 355 pixels from the centre of the diffraction pattern, which is indicated with a red cross. For this images the column limit was set to [1353 2069] and the row limit was set to [804 1523]. For visualization purposes only data was clipped in the [0 10] counts range and the contrast was adjusted between 0 and 10 -2 to highlight the most intense diffraction spots or diffraction spot clusters. The zooms (d, e, f) are taken the row limit set to [1500 1630] and the column limit set to [815 915] and the other parameters unchanged.</figDesc><graphic coords="25,86.22,230.94,439.32,283.38" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_15"><head>Figure S17 .</head><label>S17</label><figDesc>Figure S17. Examples of diffraction spot clustering (cold sample). a, sparse pattern in ROI with inset showing the clustered diffraction spot. In this case it is trivial as there is only one diffraction spot. b, intensity vs q and 𝜒𝜒 showing the original data (blue spots), the spline fitted data (mesh), and the peak position (red spot). c, line profile passing by the peak and the origin of the diffraction pattern, showing the peak position (intensity vs χ), the left hand side width at half maximum (LHS), and the right hand width at half maximum (RHS). The full with at half maximum (FWHM) is equal to LHS + RHS. d, e, f show similar plots for image index 3. g, h, i show similar plots for image index 1718.</figDesc><graphic coords="26,86.22,217.14,439.32,425.10" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_16"><head>Figure S18 .</head><label>S18</label><figDesc>Figure S18. Quiver plot (cold sample). Representation of the χ coordinate from the peak extracted from diffraction spots in each image. a, quiver plot. d, zoom in the bottom right corner. b, and c, sparse pattern of the diffraction patterns (ROI) corresponding to two positions in the quiver point.</figDesc><graphic coords="28,86.22,223.80,439.50,430.56" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_17"><head>Figure S19 .</head><label>S19</label><figDesc>Figure S19. Second level of clustering: grains detection (cold sample). a and d show the first two largest clusters (grains) overlapped to the quiver plot. b, e show a map of the q coordinates of the peaks extracted from the diffraction spots belonging to the two largest grains. c, f, show a map of the χ coordinate.</figDesc><graphic coords="29,86.22,217.14,439.50,430.62" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_18"><head>Figure S20 .</head><label>S20</label><figDesc>Figure S20. Residual distortion. Plot of q vs χ for the peak extracted from all the diffraction spots in the raster scan (cold sample).</figDesc><graphic coords="30,106.02,223.80,396.96,198.48" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_19"><head>Figure S21 .</head><label>S21</label><figDesc>Figure S21. (002) and (110) discrimination (diffraction pattern 114, cluster 3, cold sample). a, Diffraction spot showing the (002) and the (110) reflections. The 4 th degree polynomial passing by the two peaks is shown in green (Separator). Data is shown as blue 'o' and the mesh represents the 3D cubic spline interpolant. b, (002) peak detection. c, (110) peak detection. In b and c we also show the Gaussian fits and the error.</figDesc><graphic coords="31,86.22,251.40,453.54,158.70" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_20"><head>Figure S23 .</head><label>S23</label><figDesc>Figure S23. Spatial maps of diffraction spot peak properties in the largest (002) and (110) grains (medium sample). a, b, number of non-zero pixels in the diffraction spot detected in the first level of clustering.c, d, diffraction spot q p peak position. e, f, lattice constant calculated from q p . g, h, diffraction spot χ p peak position. i, j, diffraction spot peak intensity. k, l, FWHM extracted from the line profile passing by χ p and q p and the origin of the diffraction pattern.</figDesc><graphic coords="33,155.52,72.00,297.78,524.58" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_21"><head>Figure S24 .</head><label>S24</label><figDesc>Figure S24. Spatial maps of diffraction spot peak properties in the largest (002) and (110) grains (hot sample). a, b, number of non-zero pixels in the diffraction spot detected in the first level of clustering.c, d, diffraction spot q p peak position. e, f, lattice constant calculated from q p . g, h, diffraction spot χ p peak position. i, j, diffraction spot peak intensity. k, l, FWHM extracted from the line profile passing by χ p and q p and the origin of the diffraction pattern. Note that l is blank because the identified diffraction spots did not contain enough pixels for a good estimate of the FWHM.</figDesc><graphic coords="34,155.52,72.00,297.78,524.58" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_22"><head>Figure</head><figDesc>Figure S27. (110) Cold quiver magnification.</figDesc><graphic coords="37,86.22,72.00,453.48,453.48" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_23"><head>Figure</head><figDesc>Figure S28. (110) Cold quiver magnification around the largest grain (yellow thick arrows).</figDesc><graphic coords="38,86.22,72.00,453.48,453.48" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_24"><head>Figure</head><figDesc>Figure S29. (002) Medium quiver magnification.</figDesc><graphic coords="39,86.22,72.00,453.00,453.00" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_25"><head>Figure</head><figDesc>Figure S31. (110) Medium quiver magnification.</figDesc><graphic coords="41,86.22,72.00,453.00,453.00" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_26"><head>Figure</head><figDesc>Figure S32. (110) Medium quiver magnification around the largest grain (blue thick arrows).</figDesc><graphic coords="42,86.22,72.00,453.00,453.00" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_27"><head>Figure</head><figDesc>Figure S33. (002) Hot quiver magnification.</figDesc><graphic coords="43,86.22,72.00,453.00,453.00" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_28"><head>Figure</head><figDesc>Figure S36. (002) Hot quiver magnification around the largest grain (azure thick arrows).</figDesc><graphic coords="46,86.22,72.00,453.00,453.00" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0"><graphic coords="15,127.38,141.00,340.50,226.50" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0"><graphic coords="22,103.02,154.80,403.20,297.54" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0"><graphic coords="32,155.52,175.74,297.78,524.58" type="bitmap" /></figure>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" xml:id="foot_0"><p>Figure S35. (110) Hot quiver magnification.</p></note>
		</body>
		<back>
			<div type="annex">
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.9">Maps</head><p>In Figure <ref type="figure">S22</ref>, Figure <ref type="figure">S23</ref>, and Figure <ref type="figure">S24</ref> we show maps of the number of pixels in a diffraction spot as discussed in the first clustering step (a, b), the q position of the peak (c, d), the corresponding lattice constant (e, f), the χ position of the peak (g, h), the peak intensity (i, j), and the FWHM (k, l), for the (002) and (110) largest grains in the cold, medium, and hot sample respectively.  <ref type="figure">c</ref>, <ref type="figure">d</ref>, diffraction spot q p peak position. e, f, lattice constant calculated from q p . g, h, diffraction spot χ p peak position. i, j, diffraction spot peak intensity. k, l, FWHM extracted from the line profile passing by χ p and q p and the origin of the diffraction pattern.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.10">Quiver Plots Magnifications</head><p>The following are magnifications of the quiver plots shown in the manuscript.   Images having a 'reasonable' size (i.e. data{index} and image.Iav) such as the single full diffraction patterns or the average diffraction pattern can be either visualized with the 'spy' command or as regular images after converting them into full matrices with the 'full' command.</p><p>The code in Table <ref type="table">S11</ref> can be used for plotting single diffraction patterns (nongraphicHandles.data{n}) or average diffraction patterns (nongraphicHandles.image.Iav). The surface coverage reported in the manuscript is calculated with the code in Table <ref type="table">S12</ref>. The following data is obtained after the second clustering step and is different between the 002 and the 110 files. The code in Table <ref type="table">S14</ref> can be used for plotting the quiver plot.  Statistics on the degree of overlap between different grains that exist at the same spatial position, can be performed with the code in Table <ref type="table">S15</ref>. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.2">Solar Cell Measurements</head><p>JV sweeps are available as supporting files. Note that the external pixels (1 and 6) have been excluded from the statistics as they consistently perform poorly due to the proximity to the substrate edge. A faulty pixel (or a bad measurement) was found in the hot backward measurements and removed from the statistics as well.</p></div>			</div>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">Grain rotation and lattice deformation during perovskite spray coating and annealing probed &lt;i&gt;in situ&lt;/i&gt; by GI-WAXS</title>
		<author>
			<persName><forename type="first">S</forename><surname>Lilliu</surname></persName>
			<idno type="ORCID">0000-0002-8449-2211</idno>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Griffin</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">T</forename><surname>Barrows</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Alsari</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><surname>Curzadd</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><forename type="middle">G</forename><surname>Dane</surname></persName>
		</author>
		<author>
			<persName><forename type="first">O</forename><surname>Bikondoa</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">E</forename><surname>Macdonald</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">G</forename><surname>Lidzey</surname></persName>
		</author>
		<idno type="DOI">10.1039/c6ce00965d</idno>
	</analytic>
	<monogr>
		<title level="j">CrystEngComm</title>
		<title level="j" type="abbrev">CrystEngComm</title>
		<idno type="ISSNe">1466-8033</idno>
		<imprint>
			<biblScope unit="volume">18</biblScope>
			<biblScope unit="issue">29</biblScope>
			<biblScope unit="page" from="5448" to="5455" />
			<date type="published" when="2016">2016</date>
			<publisher>Royal Society of Chemistry (RSC)</publisher>
		</imprint>
	</monogr>
	<note type="raw_reference">S. Lilliu, J. Griffin, A. T. Barrows, M. Alsari, B. Curzadd, T. G. Dane, O. Bikondoa, J. E. Macdonald, and D. G. Lidzey, CrystEngComm 2016, DOi: 10.1039/C6CE00965D,</note>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">Absence of Structural Impact of Noble Nanoparticles on P3HT:PCBM Blends for Plasmon-Enhanced Bulk-Heterojunction Organic Solar Cells Probed by Synchrotron GI-XRD</title>
		<author>
			<persName><forename type="first">Samuele</forename><surname>Lilliu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Mejd</forename><surname>Alsari</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Oier</forename><surname>Bikondoa</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Emyr Macdonald</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Marcus</forename><forename type="middle">S</forename><surname>Dahlem</surname></persName>
		</author>
		<idno type="DOI">10.1038/srep10633</idno>
	</analytic>
	<monogr>
		<title level="j">Scientific Reports</title>
		<title level="j" type="abbrev">Sci Rep</title>
		<idno type="ISSNe">2045-2322</idno>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="issue">1</biblScope>
			<date type="published" when="2014">2014</date>
			<publisher>Springer Science and Business Media LLC</publisher>
		</imprint>
	</monogr>
	<note type="raw_reference">S. Lilliu, M. Alsari, O. Bikondoa, J. E. Macdonald, and M. S. Dahlem, Sci. Rep. 2014, 5,</note>
</biblStruct>

<biblStruct xml:id="b2">
	<monogr>
		<title/>
		<author>
			<persName><forename type="first">S</forename><surname>Lilliu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><surname>Dane</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1511.06224</idno>
		<idno>cond-mat.soft</idno>
		<imprint>
			<date type="published" when="2015">2015</date>
		</imprint>
	</monogr>
	<note type="raw_reference">S. Lilliu and T. Dane, arXiv:1511.06224 [cond-mat.soft] 2015, -,</note>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Dynamics of Crystallization and Disorder during Annealing of P3HT/PCBM Bulk Heterojunctions</title>
		<author>
			<persName><forename type="first">Samuele</forename><surname>Lilliu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Tiziano</forename><surname>Agostinelli</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Ellis</forename><surname>Pires</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Mark</forename><surname>Hampton</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Jenny</forename><surname>Nelson</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">Emyr</forename><surname>Macdonald</surname></persName>
		</author>
		<idno type="DOI">10.1021/ma102817z</idno>
	</analytic>
	<monogr>
		<title level="j">Macromolecules</title>
		<title level="j" type="abbrev">Macromolecules</title>
		<idno type="ISSN">0024-9297</idno>
		<idno type="ISSNe">1520-5835</idno>
		<imprint>
			<biblScope unit="volume">44</biblScope>
			<biblScope unit="issue">8</biblScope>
			<biblScope unit="page" from="2725" to="2734" />
			<date type="published" when="2011-03-16">2011. 2725</date>
			<publisher>American Chemical Society (ACS)</publisher>
		</imprint>
	</monogr>
	<note type="raw_reference">S. Lilliu, T. Agostinelli, E. Pires, M. Hampton, J. Nelson, and J. E. Macdonald, Macromolecules 2011, 44, 2725.</note>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Thin Film Analysis by X‐Ray Scattering</title>
		<author>
			<persName><forename type="first">Mario</forename><surname>Birkholz</surname></persName>
		</author>
		<idno type="DOI">10.1002/3527607595</idno>
	</analytic>
	<monogr>
		<title level="m">Thin Film Analysis by X-Ray Scattering</title>
		<imprint>
			<publisher>Wiley</publisher>
			<date type="published" when="2006">2006</date>
		</imprint>
	</monogr>
	<note type="raw_reference">M. Birkholz, Thin Film Analysis by X-Ray Scattering. John Wiley &amp; Sons, 2006.</note>
</biblStruct>

<biblStruct xml:id="b5">
	<monogr>
		<author>
			<persName><surname>The_Center_For_X-Ray_Optics</surname></persName>
		</author>
		<ptr target="http://henke.lbl.gov/optical_constants/getdb2.html" />
		<title level="m">X-Ray Interactions with Matter</title>
		<imprint>
			<date type="published" when="2016">2016</date>
			<biblScope unit="page">4</biblScope>
		</imprint>
	</monogr>
	<note type="raw_reference">The_Center_for_X-Ray_Optics, X-Ray Interactions with Matter, http://henke.lbl.gov/optical_constants/getdb2.html, accessed: 04, 2016.</note>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">Elements of Modern X‐ray Physics</title>
		<author>
			<persName><forename type="first">Jens</forename><surname>Als‐nielsen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Des</forename><surname>Mcmorrow</surname></persName>
		</author>
		<idno type="DOI">10.1002/9781119998365</idno>
	</analytic>
	<monogr>
		<title level="m">Elements of modern X-ray physics</title>
		<imprint>
			<publisher>Wiley</publisher>
			<date type="published" when="2011-03-18">2011</date>
		</imprint>
	</monogr>
	<note type="raw_reference">J. Als-Nielsen and D. McMorrow, Elements of modern X-ray physics. John Wiley &amp; Sons, 2011.</note>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">Scherrer grain-size analysis adapted to grazing-incidence scattering with area detectors</title>
		<author>
			<persName><forename type="first">D.-M</forename><surname>Smilgies</surname></persName>
		</author>
		<idno type="DOI">10.1107/s0021889809040126</idno>
	</analytic>
	<monogr>
		<title level="j">Journal of Applied Crystallography</title>
		<title level="j" type="abbrev">J Appl Crystallogr</title>
		<idno type="ISSN">0021-8898</idno>
		<imprint>
			<biblScope unit="volume">42</biblScope>
			<biblScope unit="issue">6</biblScope>
			<biblScope unit="page" from="1030" to="1034" />
			<date type="published" when="2009-10-15">2009</date>
			<publisher>International Union of Crystallography (IUCr)</publisher>
		</imprint>
	</monogr>
	<note type="raw_reference">D.-M. Smilgies, J. Appl. Crystallogr. 2009, 42,</note>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">Influence of Thermal Processing Protocol upon the Crystallization and Photovoltaic Performance of Organic–Inorganic Lead Trihalide Perovskites</title>
		<author>
			<persName><forename type="first">Michael</forename><surname>Saliba</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Kwan</forename><forename type="middle">Wee</forename><surname>Tan</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Hiroaki</forename><surname>Sai</surname></persName>
		</author>
		<author>
			<persName><forename type="first">David</forename><forename type="middle">T</forename><surname>Moore</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Trent</forename><surname>Scott</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Wei</forename><surname>Zhang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Lara</forename><forename type="middle">A</forename><surname>Estroff</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Ulrich</forename><surname>Wiesner</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Henry</forename><forename type="middle">J</forename><surname>Snaith</surname></persName>
		</author>
		<idno type="DOI">10.1021/jp500717w</idno>
	</analytic>
	<monogr>
		<title level="j">The Journal of Physical Chemistry C</title>
		<title level="j" type="abbrev">J. Phys. Chem. C</title>
		<idno type="ISSN">1932-7447</idno>
		<idno type="ISSNe">1932-7455</idno>
		<imprint>
			<biblScope unit="volume">118</biblScope>
			<biblScope unit="issue">30</biblScope>
			<biblScope unit="page" from="17171" to="17177" />
			<date type="published" when="2014-04-11">2014</date>
			<publisher>American Chemical Society (ACS)</publisher>
		</imprint>
	</monogr>
	<note type="raw_reference">M. Saliba, K. W. Tan, H. Sai, D. T. Moore, T. Scott, W. Zhang, L. A. Estroff, U. Wiesner, and H. J. Snaith, The Journal of Physical Chemistry C 2014, 118,</note>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Crystallization Kinetics of Organic–Inorganic Trihalide Perovskites and the Role of the Lead Anion in Crystal Growth</title>
		<author>
			<persName><forename type="first">David</forename><forename type="middle">T</forename><surname>Moore</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Hiroaki</forename><surname>Sai</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Kwan</forename><forename type="middle">W</forename><surname>Tan</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Null-</forename><forename type="middle">M</forename><surname>Smilgies</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Wei</forename><surname>Zhang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Henry</forename><forename type="middle">J</forename><surname>Snaith</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Ulrich</forename><surname>Wiesner</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Lara</forename><forename type="middle">A</forename><surname>Estroff</surname></persName>
		</author>
		<idno type="DOI">10.1021/ja512117e</idno>
	</analytic>
	<monogr>
		<title level="j">Journal of the American Chemical Society</title>
		<title level="j" type="abbrev">J. Am. Chem. Soc.</title>
		<idno type="ISSN">0002-7863</idno>
		<idno type="ISSNe">1520-5126</idno>
		<imprint>
			<biblScope unit="volume">137</biblScope>
			<biblScope unit="issue">6</biblScope>
			<biblScope unit="page" from="2350" to="2358" />
			<date type="published" when="2015-02-09">2015</date>
			<publisher>American Chemical Society (ACS)</publisher>
		</imprint>
	</monogr>
	<note type="raw_reference">D. T. Moore, H. Sai, K. W. Tan, D.-M. Smilgies, W. Zhang, H. J. Snaith, U. Wiesner, and L. A. Estroff, J. Am. Chem. Soc. 2015, 137, 2350.</note>
</biblStruct>

<biblStruct xml:id="b10">
	<monogr>
		<title level="m" type="main">Source code 1.</title>
		<author>
			<persName><forename type="first">Matlab</forename><surname>Mathworks</surname></persName>
		</author>
		<author>
			<persName><surname>Documentation</surname></persName>
		</author>
		<idno type="DOI">10.7554/elife.07290.011</idno>
		<ptr target="http://uk.mathworks.com/help/MATLAB/getting-started-with-MATLAB.html" />
		<imprint>
			<date type="published" when="2016">2016</date>
			<publisher>eLife Sciences Publications, Ltd</publisher>
			<biblScope unit="page">4</biblScope>
		</imprint>
	</monogr>
	<note type="raw_reference">MathWorks, MATLAB Documentation, http://uk.mathworks.com/help/MATLAB/getting- started-with-MATLAB.html, accessed: 04, 2016.</note>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Numerical Mathematics</title>
		<author>
			<persName><forename type="first">Alfio</forename><surname>Quarteroni</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Riccardo</forename><surname>Sacco</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Fausto</forename><surname>Saleri</surname></persName>
		</author>
		<idno type="DOI">10.1007/978-0-387-22750-4</idno>
	</analytic>
	<monogr>
		<title level="m">Numerical mathematics</title>
		<imprint>
			<publisher>Springer New York</publisher>
			<date type="published" when="2010">2010</date>
		</imprint>
	</monogr>
	<note type="raw_reference">A. Quarteroni, R. Sacco, and F. Saleri, Numerical mathematics. Springer Science &amp; Business Media, 2010.</note>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">Reduction of two-dimensional small- and wide-angle X-ray scattering data</title>
		<author>
			<persName><forename type="first">Peter</forename><surname>Boesecke</surname></persName>
		</author>
		<idno type="DOI">10.1107/s0021889807001100</idno>
	</analytic>
	<monogr>
		<title level="j">Journal of Applied Crystallography</title>
		<title level="j" type="abbrev">J Appl Crystallogr</title>
		<idno type="ISSN">0021-8898</idno>
		<imprint>
			<biblScope unit="volume">40</biblScope>
			<biblScope unit="issue">s1</biblScope>
			<biblScope unit="page" from="s423" to="s427" />
			<date type="published" when="2007-01-26">2007, 40, s423</date>
			<publisher>International Union of Crystallography (IUCr)</publisher>
		</imprint>
	</monogr>
	<note type="raw_reference">P. Boesecke, J. Appl. Crystallogr. 2007, 40, s423.</note>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">The fast azimuthal integration Python library:&lt;i&gt;pyFAI&lt;/i&gt;</title>
		<author>
			<persName><forename type="first">Giannis</forename><surname>Ashiotis</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Aurore</forename><surname>Deschildre</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Zubair</forename><surname>Nawaz</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Jonathan</forename><forename type="middle">P</forename><surname>Wright</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Dimitrios</forename><surname>Karkoulis</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Frédéric</forename><forename type="middle">Emmanuel</forename><surname>Picca</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Jérôme</forename><surname>Kieffer</surname></persName>
		</author>
		<idno type="DOI">10.1107/s1600576715004306</idno>
	</analytic>
	<monogr>
		<title level="j">Journal of Applied Crystallography</title>
		<title level="j" type="abbrev">J Appl Crystallogr</title>
		<idno type="ISSNe">1600-5767</idno>
		<imprint>
			<biblScope unit="volume">48</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="510" to="519" />
			<date type="published" when="2015-03-24">2015</date>
			<publisher>International Union of Crystallography (IUCr)</publisher>
		</imprint>
	</monogr>
	<note type="raw_reference">G. Ashiotis, A. Deschildre, Z. Nawaz, J. P. Wright, D. Karkoulis, F. E. Picca, and J. Kieffer, J. Appl. Crystallogr. 2015, 48, 510.</note>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">PyFAI: a Python library for high performance azimuthal integration on GPU</title>
		<author>
			<persName><forename type="first">J</forename><surname>Kieffer</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">P</forename><surname>Wright</surname></persName>
		</author>
		<idno type="DOI">10.1017/s0885715613000924</idno>
		<ptr target="http://pyfai.readthedocs.org/en/latest/index.html" />
	</analytic>
	<monogr>
		<title level="j">Powder Diffraction</title>
		<title level="j" type="abbrev">Powder Diffr.</title>
		<idno type="ISSN">0885-7156</idno>
		<idno type="ISSNe">1945-7413</idno>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="issue">S2</biblScope>
			<biblScope unit="page" from="S339" to="S350" />
			<date type="published" when="2016">2016</date>
			<publisher>Cambridge University Press (CUP)</publisher>
		</imprint>
	</monogr>
	<note type="raw_reference">pyFAI, Fast Azimuthal Integration using Python, http://pyfai.readthedocs.org/en/latest/index.html, accessed: 04, 2016.</note>
</biblStruct>

<biblStruct xml:id="b15">
	<monogr>
		<title/>
		<author>
			<persName><forename type="first">K</forename><surname>Jérôme</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><surname>Dimitrios</surname></persName>
		</author>
		<author>
			<persName><surname>Jpcs</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2013">2013. 202012</date>
			<biblScope unit="volume">425</biblScope>
		</imprint>
	</monogr>
	<note type="raw_reference">K. Jérôme and K. Dimitrios, JPCS 2013, 425, 202012.</note>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">PyFAI: a Python library for high performance azimuthal integration on GPU</title>
		<author>
			<persName><forename type="first">J</forename><surname>Kieffer</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">P</forename><surname>Wright</surname></persName>
		</author>
		<idno type="DOI">10.1017/s0885715613000924</idno>
		<ptr target="http://pyfai.readthedocs.org/en/latest/index.html" />
	</analytic>
	<monogr>
		<title level="j">Powder Diffraction</title>
		<title level="j" type="abbrev">Powder Diffr.</title>
		<idno type="ISSN">0885-7156</idno>
		<idno type="ISSNe">1945-7413</idno>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="issue">S2</biblScope>
			<biblScope unit="page" from="S339" to="S350" />
			<date type="published" when="2013-09" />
			<publisher>Cambridge University Press (CUP)</publisher>
		</imprint>
	</monogr>
	<note type="raw_reference">pyFAI, Fast Azimuthal Integration using Python, http://pyfai.readthedocs.org/en/latest/index.html, accessed:</note>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title level="a" type="main">A profile refinement method for nuclear and magnetic structures</title>
		<author>
			<persName><forename type="first">H</forename><forename type="middle">M</forename><surname>Rietveld</surname></persName>
		</author>
		<idno type="DOI">10.1107/s0021889869006558</idno>
	</analytic>
	<monogr>
		<title level="j">Journal of Applied Crystallography</title>
		<title level="j" type="abbrev">J Appl Crystallogr</title>
		<idno type="ISSN">0021-8898</idno>
		<imprint>
			<biblScope unit="volume">2</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="65" to="71" />
			<date type="published" when="1969-06-02">1969, 2, 65</date>
			<publisher>International Union of Crystallography (IUCr)</publisher>
		</imprint>
	</monogr>
	<note type="raw_reference">H. Rietveld, J. Appl. Crystallogr. 1969, 2, 65.</note>
</biblStruct>

<biblStruct xml:id="b18">
	<analytic>
		<title level="a" type="main">Semiconducting Tin and Lead Iodide Perovskites with Organic Cations: Phase Transitions, High Mobilities, and Near-Infrared Photoluminescent Properties</title>
		<author>
			<persName><forename type="first">Constantinos</forename><forename type="middle">C</forename><surname>Stoumpos</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Christos</forename><forename type="middle">D</forename><surname>Malliakas</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Mercouri</forename><forename type="middle">G</forename><surname>Kanatzidis</surname></persName>
		</author>
		<idno type="DOI">10.1021/ic401215x</idno>
		<ptr target="http://www.blendswap.com/blends/view/80149" />
	</analytic>
	<monogr>
		<title level="j">Inorganic Chemistry</title>
		<title level="j" type="abbrev">Inorg. Chem.</title>
		<idno type="ISSN">0020-1669</idno>
		<idno type="ISSNe">1520-510X</idno>
		<imprint>
			<biblScope unit="volume">52</biblScope>
			<biblScope unit="issue">15</biblScope>
			<biblScope unit="page" from="9019" to="9038" />
			<date type="published" when="2013-07-08">2013</date>
			<publisher>American Chemical Society (ACS)</publisher>
		</imprint>
	</monogr>
	<note type="raw_reference">C. C. Stoumpos, C. D. Malliakas, and M. G. Kanatzidis, lnorg. Chem. 2013, 52, 9019. NOTE on Figure 1a-b of the manuscript. Microscope part, credits: muhtesemozcinar, http://www.blendswap.com/blends/view/80149</note>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
